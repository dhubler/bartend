<html>
    <head>
    <script src="bower_components/webcomponentsjs/webcomponents-lite.js">
    </script>
    <link rel="import" href="bower_components/polymer/polymer.html">
    <link rel="import" href="bower_components/paper-tabs/paper-tabs.html">
    <link rel="import" href="bower_components/paper-tabs/paper-tab.html">
    <link rel="import" href="bower_components/paper-card/paper-card.html">
    <link rel="import" href="bower_components/iron-pages/iron-pages.html">
    <link rel="import" href="src/bartend-recipe.html">
    <link rel="import" href="src/bartend-pump.html">
    <style is="custom-style">
        * {
            box-sizing: border-box;
        }
        .link {
            @apply(--layout-horizontal);
            @apply(--layout-center-center);
        }
        .card {
            width: 100%;
        }
    </style>
    </head>
    <body>        
        <template id="t" is="dom-bind">
            <paper-tabs id="menu" selected="{{selected}}">
                <paper-tab link><a href="#recipes" class="link" tabindex="-1">Recipes</a></paper-tab>
                <paper-tab link><a href="#setup" class="link" tabindex="-1">Setup</a></paper-tab>
            </paper-tabs>
            <iron-pages selected="{{selected}}">
                <div id="recipes">
                    <template is="dom-repeat" items="{{data.recipe}}">
                        <paper-card class="card">
                            <bartend-recipe api-url="/restconf/recipe={{item.name}}/" recipe="{{item}}"></bartend-recipe>
                        </paper-card>
                    </template>
                </div>
                <div id="setup">            
                    <template is="dom-repeat" items="{{data.pump}}">
                        <paper-card class="card">
                            <bartend-pump api-url="/restconf/pump={{item.id}}/" pump="{{item}}"></bartend-pump>
                        </paper-card>
                    </template>
                </div>
            </iron-pages>
        </template>
        <script>
var t = document.querySelector("#t");
t.selected = 0;        
t.data = {};
t.addEventListener('dom-change', function() {
    var r = new XMLHttpRequest();
    r.open("GET", "/restconf/", true);
    r.onreadystatechange = function () {
        if (r.readyState != 4 || r.status != 200) {
            return;
        }
        t.data = JSON.parse(r.responseText);
    };
    r.send();      
}); 
        </script>
    </body>
</html>