<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bartend-drink/bartend-drink.html">

<!--
    `<bartend-recipe>` - Show an individual recipe. Launch point for actually 
      making the drink.
-->    
<dom-module id="bartend-recipe">
  <template strip-whitespace>
    <style>
      :host {
        display: block;
        margin: 1px;
        padding: 5px;
      }
      .ingredient {
        list-style-type: none;      
      }
      .content {
        display: flex;
        flex-direction: row;
      }
      .main {
        flex: 1;
      }
      .body {
        flex: 2;
        font-size: large;
      }
      paper-button.major {
        background-color: #2196f3;
        color: #ffffff;
      }
      .buttonBar {
        display: flex;
        flex-direction: row;
      }
      .buttonSpacer {
        flex: 1;
      }
    </style>
    <div class="content">
      <div class="main">
        <h1>[[recipe.name]]</h1>
        <p>[[recipe.description]]</p>
      </div>
      <div class="body">
        <ul>
        <template is="dom-repeat" items="[[recipe.ingredient]]">
          <li class="ingredient">[[item.amount]] oz [[item.liquid]]</li>
        </template>
        </ul>
        <div class="buttonBar">
          <paper-button raised class="major" on-tap="make">Make</paper-button>
          <paper-button raised on-tap="sample">Sample</paper-button>
        </div>
      </div>
    </div>
    <paper-dialog modal id="drinkDialog">
      <bartend-drink id="drink" recipe="[[recipe]]" on-done="_closeDrinkDialog"></bartend-drink>
    </paper-dialog>
  </template>

  <script>
    'use strict';
    class BartendRecipe extends Polymer.GestureEventListeners(Polymer.Element) {

      static get is() {
          return 'bartend-recipe';
      }
      
      static get properties() {
        return {
          /**
           * recipe object from REST API
           */
          recipe  : {
            type : Object,
            value: function() {
              return {};
            }
          }
        }
      }

      /**
       * pour just a sample of this recipe into the glass
       */
      sample() {
        this.scale(0.1);
      }

      /**
       * make this recipe
       */
      make() {
        this.scale(1);
      }

      /**
       * make a scaled up or down version of this recipe
       * 
       * @param {number} e.g. 0.1 for sample, 2 for a double
       */
      scale(multiplier) {
        this.$.drinkDialog.toggle();
        this.$.drink.start(multiplier);        
      }

      _closeDrinkDialog() {
        this.$.drinkDialog.close();
      }
    }
    customElements.define(BartendRecipe.is, BartendRecipe);
  </script>

</dom-module>

